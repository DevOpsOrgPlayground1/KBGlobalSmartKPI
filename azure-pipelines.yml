# Starter pipeline

trigger:
- main

pool:
  vmImage: windows-latest

steps:
- checkout: none
  persistCredentials: true

- script: |
    git config --global user.email nitin.srivastava@knorr-bremse.com 
    git config --global user.name "nitin-sriv"
  workingDirectory: $(System.DefaultWorkingDirectory)

- script: |
    git init
    git remote add origin https://github.com/DevOpsOrgPlayground1/KBGlobalSmartKPI
    git checkout DevOpsOrgPlayground1/KBGlobalSmartKPI -b temp
    ant -noinput -buildfile build-extension.xml
    git add -A
    echo "added extension zip"
    git status
    git commit -m "deployment $(Build.BuildNumber)"
    echo "commited extension zip"
    git branch -vv
    echo "list tracking branches"
    git ls-remote
    echo "list remote branches"
    git push --set-upstream origin temp
    git push origin --delete temp
  displayName: 'Creating a TWX Extension and checkin'
